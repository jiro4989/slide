@startuml

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' 登場人物の定義
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

[GitHub]
[Travis CI]
Actor Developer as dev
[docker-compose]

frame "Docker" {
  frame "Shellcheck container" {
    [shellcheck]
  }
  frame "Shfmt container" {
    [shfmt]
  }
  frame "Bash default container" {
    [bats 1]
    [bash default]
  }
  frame "Bash 3.0 container" {
    [bats 2]
    [bash 3.0]
  }
  frame "Bash 4.0 container" {
    [bats 3]
    [bash 4.0]
  }
  frame "Bash 4.1 container" {
    [bats 4]
    [bash 4.1]
  }
  frame "Bash 4.2 container" {
    [bats 5]
    [bash 4.2]
  }
  frame "Bash 4.3 container" {
    [bats 6]
    [bash 4.3]
  }
  frame "Bash 4.4 container" {
    [bats 7]
    [bash 4.4]
  }
  frame "Bash 5.0 container" {
    [bats 8]
    [bash 5.0]
  }
}

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' フローの定義
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' 開発者を起点とするフロー
dev -> [docker-compose]
[docker-compose] -> [shellcheck]
[docker-compose] -> [shfmt]
' Bats + Bashはセット
[docker-compose] -> [bats 1]
[docker-compose] -> [bats 2]
[docker-compose] -> [bats 3]
[docker-compose] -> [bats 4]
[docker-compose] -> [bats 5]
[docker-compose] -> [bats 6]
[docker-compose] -> [bats 7]
[docker-compose] -> [bats 8]
[bats 1] -> [bash default]
[bats 2] -> [bash 3.0]
[bats 3] -> [bash 4.0]
[bats 4] -> [bash 4.1]
[bats 5] -> [bash 4.2]
[bats 6] -> [bash 4.3]
[bats 7] -> [bash 4.4]
[bats 8] -> [bash 5.0]

' ソースコードの参照
[shellcheck] -> [Source code]
[shfmt] -> [Source code]
[bash default] -> [Source code]
[bash 3.0] -> [Source code]
[bash 4.0] -> [Source code]
[bash 4.1] -> [Source code]
[bash 4.2] -> [Source code]
[bash 4.3] -> [Source code]
[bash 4.4] -> [Source code]
[bash 5.0] -> [Source code]

' GitHubにPushを起点とするフロー
dev -> [GitHub]
[GitHub] -> [Travis CI]
[Travis CI] -> [docker-compose]

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' 位置調整
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' dev -> docker-compose -> docker -> source codeという配置にしたい
dev -[hidden]right- [docker-compose]
[docker-compose] -[hidden]right- [shellcheck]
[docker-compose] -[hidden]right- [shfmt]
[docker-compose] -[hidden]right- [bats 1]
[docker-compose] -[hidden]right- [bats 2]
[docker-compose] -[hidden]right- [bats 3]
[docker-compose] -[hidden]right- [bats 4]
[docker-compose] -[hidden]right- [bats 5]
[docker-compose] -[hidden]right- [bats 6]
[docker-compose] -[hidden]right- [bats 7]
[docker-compose] -[hidden]right- [bats 8]

[bats 1] -[hidden]right- [bash default]
[bats 2] -[hidden]right- [bash 3.0]
[bats 3] -[hidden]right- [bash 4.0]
[bats 4] -[hidden]right- [bash 4.1]
[bats 5] -[hidden]right- [bash 4.2]
[bats 6] -[hidden]right- [bash 4.3]
[bats 7] -[hidden]right- [bash 4.4]
[bats 8] -[hidden]right- [bash 5.0]

[shellcheck] -[hidden]right- [Source code]
[shfmt] -[hidden]right- [Source code]
[bash default] -[hidden]right- [Source code]
[bash 3.0] -[hidden]right- [Source code]
[bash 4.0] -[hidden]right- [Source code]
[bash 4.1] -[hidden]right- [Source code]
[bash 4.2] -[hidden]right- [Source code]
[bash 4.3] -[hidden]right- [Source code]
[bash 4.4] -[hidden]right- [Source code]
[bash 5.0] -[hidden]right- [Source code]

' Dockerコンテナグループでの配置
' shellcheck -down-> shfmt -down-> bash としたい
[shellcheck] -[hidden]down- [shfmt]
[shfmt] -[hidden]down- [bash default]
[bash default] -[hidden]down- [bash 3.0]
[bash 3.0] -[hidden]down- [bash 4.0]
[bash 4.0] -[hidden]down- [bash 4.1]
[bash 4.1] -[hidden]down- [bash 4.2]
[bash 4.2] -[hidden]down- [bash 4.3]
[bash 4.3] -[hidden]down- [bash 4.4]
[bash 4.4] -[hidden]down- [bash 5.0]

' GitHub, TravisCIなどのクラウド組はdevより上
dev -[hidden]up- [GitHub]
dev -[hidden]up- [Travis CI]
[docker-compose] -[hidden]up- [GitHub]
[docker-compose] -[hidden]up- [Travis CI]

@enduml
